# spec/go_excel_exporter_input_spec.yaml
# Спецификация формата JSON-входных данных для go_excel_exporter

version: "1.0"

# Корневой объект
input_schema:
  type: object
  properties:
    project_name:
      type: string
      description: "Название проекта (без расширения)"
    sheets:
      type: array
      items:
        type: object
        properties:
          name:
            type: string
            description: "Название листа"
          
            type: array
            description: "Двумерный массив данных ячеек (строки)"
            items:
              type: array
              items:
                type: [string, number, boolean, "null"]
          formulas:
            type: array
            description: "Массив формул в формате [cell, formula]"
            items:
              type: object
              properties:
                cell:
                  type: string
                formula:
                  type: string
              required:
                - cell
                - formula
          styles:
            type: array
            description: "Массив стилей ячеек в формате объекта Style"
            items:
              type: object
              properties:
                range:
                  type: string
                  description: "Диапазон ячеек, например, \"A1:C10\""
                style:
                  type: object
                  description: "Словарь атрибутов стиля"
                  # Структура атрибутов стиля может быть сложной, определяется Excelize
                  additionalProperties: true
              required:
                - range
                - style
          merged_cells:
            type: array
            description: "Массив объединенных ячеек в формате ['A1:B2']"
            items:
              type: string
          charts:
            type: array
            description: "Массив диаграмм для листа"
            items:
              type: object
              properties:
                type:
                  type: string
                  description: "Тип диаграммы (e.g., 'col', 'line', 'pie')"
                position:
                  type: string
                  description: "Ячейка для размещения диаграммы, например, \"E5\""
                title:
                  type: [string, "null"]
                  description: "Заголовок диаграммы (может быть null)"
                series:
                  type: array
                  description: "Серии данных диаграммы"
                  items:
                    type: object
                    properties:
                      name:
                        type: [string, "null"]
                        description: "Название серии (может быть null)"
                      categories:
                        type: [string, "null"]
                        description: "Диапазон категорий (например, A1:A5, может быть null)"
                      values:
                        type: string
                        description: "Диапазон значений (например, B1:B2)"
                    required:
                      - values # name и categories опциональны
              required:
                - type
                - position
                - series
        required:
          - name
          - data
  required:
    - project_name
    - sheets

# Пример структуры стиля (для справки)
# style_schema:
#   type: object
#   properties:
#     font:
#       type: object
#     fill:
#       type: object
#     alignment:
#       type: object
#     border:
#       type: object
#   additionalProperties: true
