# Структура проекта Excel Micro DB

## Общая архитектура

Проект состоит из двух основных частей:

1.  **Backend (Python):** Обеспечивает основную логику, анализ Excel, работу с БД и API (если используется).
2.  **Frontend (GUI, Electron + React):** Обеспечивает пользовательский интерфейс, взаимодействующий с бэкендом.

## Backend (Python)

Расположение: `./`

*   `main.py`: Основной точкой входа для CLI и потенциального HTTP-сервера.
*   `backend/`: Содержит основную логику Python-приложения (анализ, хранение, экспорт).
*   `config/`: Файлы конфигурации (YAML, JSON).
*   `data/`: Входные и выходные данные.
*   `logs/`: Лог-файлы.
*   `tests/`: Тесты для Python-кода.

## Frontend (GUI, Electron + React + Vite + Tailwind CSS)

Расположение: `./frontend`

*   `package.json`: Зависимости и скрипты npm.
*   `vite.config.ts`: Конфигурация Vite.
*   `tsconfig.json`: Конфигурация TypeScript.
*   `src/`: Исходный код React-приложения.
    *   `components/`: Компоненты React (MainLayout, DataTable, NodeEditor и др.).
        *   `layout/`: Основной макет (MainLayout).
        *   `toolbar/`: Компоненты меню, ленты, строки формул (в разработке).
        *   `explorer/`: Обозреватель проекта (в разработке).
        *   `table/`: Компонент DataTable (интеграция с ag-Grid).
        *   `node-editor/`: Компоненты нодового редактора (NodeEditor, NodeTypes, NodeProperties) (интеграция с React Flow).
        *   `context_menus/`: Универсальные компоненты для контекстных меню.
    *   `config/`: **Конфигурационные файлы YAML для структуры интерфейса.**
        *   `menu/`: Структура главного меню (например, `main_menu.yaml`) (в разработке).
        *   `context_menus/`: Структура контекстных меню (например, `node_editor_pane.yaml`, `base_node.yaml`).
    *   `App.tsx`: Корневой компонент React.
    *   `main.tsx`: Точка входа для React.
    *   `index.css`: Основные стили (Tailwind).
*   `index.html`: Корневой HTML-файл для Vite.
*   `main.cjs`: Точка входа для Electron (управляет окном).
*   `node_modules/`: Установленные npm-пакеты (игнорируется Git).
*   `dist/`: Результат сборки Vite (игнорируется Git).

### Используемые библиотеки (Frontend)

*   `react`, `react-dom`: Фреймворк для построения UI.
*   `vite`: Инструмент сборки.
*   `typescript`: Язык программирования.
*   `tailwindcss`: Фреймворк для стилей.
*   `ag-grid-community`, `@ag-grid-community/react`: Компонент таблицы.
*   `reactflow`: Компонент нодового редактора.
*   `electron`: Обертка для создания десктопного приложения.

### Хранение структуры интерфейса (в т.ч. меню)

*   **Меню и Контекстные меню:** Структура пунктов меню, подменю и действий определяется в **YAML-файлах** в директории `frontend/src/config/`.
*   **Цель:** Обеспечить гибкость, локализацию и лёгкость внесения изменений без изменения кода компонентов.
*   **Пример:** `frontend/src/config/context_menus/node_editor_pane.yaml` определяет, какие пункты появляются в контекстном меню при ПКМ на пустом месте в `NodeEditor`.

## Взаимодействие компонентов (Текущее состояние)

1.  **GUI (React):** Отображает интерфейс, получает ввод пользователя.
2.  **GUI (Electron):** Запускает React-приложение в десктопном окне. Может взаимодействовать с файловой системой (в будущем, через IPC или запуск Python-скриптов).
3.  **Backend (Python):** Выполняет основную логику (анализ, экспорт). Может быть запущен как отдельный HTTP-сервер, с которым GUI взаимодействует по API, или вызываться напрямую через IPC (Electron) или CLI (Python) в будущем.

### Реализованные компоненты GUI

*   **`MainLayout`:** Базовая сетка интерфейса (меню, лента, обозреватель, таблица, нодовый редактор, панель свойств).
*   **`DataTable`:** Интеграция с `ag-Grid`, отображение и базовое редактирование данных.
*   **`NodeEditor`:** Интеграция с `React Flow`, отображение, создание, удаление кастомных узлов (Formula, Python), базовые UI элементы (Controls, MiniMap, Background).
*   **`ContextMenu`:** Универсальный компонент, использующий YAML-конфигурации для отображения меню по ПКМ (реализовано для `NodeEditor`).
*   **`YAML Configs`:** Структура контекстных меню определена в `frontend/src/config/context_menus/`.

### Планы по развитию GUI

*   **Интеграция с бэкендом:** Реализовать вызовы Python-логики из GUI (через HTTP API или IPC).
*   **Полноценные компоненты:** Реализовать `Menu`, `Ribbon`, `FormulaBar`, `ProjectExplorer`, `NodeProperties`.
*   **Логика нодового редактора:** Реализовать соединения между узлами, выполнение цепочек узлов.
*   **Управление состоянием:** Внедрить библиотеку (например, Zustand) для централизованного хранения данных проекта и состояния UI.
*   **Темы:** Доработать переключение светлой/тёмной темы.

На текущем этапе GUI запускается как standalone-приложение, отображая каркас интерфейса (таблица, нодовый редактор). Взаимодействие с бэкендом ещё не реализовано. Структура контекстных меню определяется через YAML-файлы. Реализованы базовые компоненты макета, таблицы и нодового редактора.
