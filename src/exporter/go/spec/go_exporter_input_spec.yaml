# Спецификация формата JSON для go_excel_exporter
version: "1.0.0"

# Корневой объект
root:
  type: object
  properties:
    metadata:
      $ref: "#/definitions/ProjectMetadata"
    sheets:
      type: array
      items:
        $ref: "#/definitions/SheetData"

# Определения
# --- ProjectMetadata ---
# Метаданные проекта
definitions:
  ProjectMetadata:
    type: object
    properties:
      project_name:
        type: string
        description: "Имя проекта"
      author:
        type: string
        description: "Автор проекта"
      created_at:
        type: string
        format: date-time
        description: "Дата и время создания проекта в формате ISO 8601"

  # --- SheetData ---
  # Данные для одного листа Excel
  SheetData:
    type: object
    properties:
      name:
        type: string
        description: "Имя листа Excel"
      data:
        type: array
        description: "Двумерный массив данных ячеек. Пустая ячейка представляется как null."
        items:
          type: array
          items:
            type: ["string", "number", "boolean", "null"]
      formulas:
        type: array
        items:
          $ref: "#/definitions/Formula"
      styles:
        type: array
        items:
          $ref: "#/definitions/Style"
      charts:
        type: array
        items:
          $ref: "#/definitions/Chart"
      merged_cells:
        type: array
        description: "Список строковых адресов диапазонов для объединения."
        items:
          type: string
          example: "A1:B2"

  # --- Formula ---
  # Описание формулы в ячейке
  Formula:
    type: object
    properties:
      cell:
        type: string
        description: "Адрес ячейки, например 'A1'"
      formula:
        type: string
        description: "Формула, начинающаяся с '='"

  # --- Style ---
  # Описание стиля для диапазона ячеек
  Style:
    type: object
    properties:
      range:
        type: string
        description: "Адрес диапазона, например 'A1:C10'"
      style:
        type: object
        description: "Словарь атрибутов стиля, понятный excelize"
        # TODO: Уточнить структуру style_attributes на основе документации excelize
        # Например:
        # font: {...}
        # fill: {...}
        # border: {...}
        # alignment: {...}
        # number_format: ...
        # protection: {...}

  # --- Chart ---
  # Описание диаграммы
  Chart:
    type: object
    properties:
      type:
        type: string
        description: "Тип диаграммы, понятный excelize (например, 'col', 'line', 'pie')"
      position:
        type: string
        description: "Адрес ячейки для размещения диаграммы, например 'E5'"
      title:
        type: string
        nullable: true
        description: "Заголовок диаграммы"
      series:
        type: array
        items:
          $ref: "#/definitions/ChartSeries"

  # --- ChartSeries ---
  # Описание одной серии данных для диаграммы
  ChartSeries:
    type: object
    properties:
      name:
        type: string
        nullable: true
        description: "Имя серии данных (например, ссылка на ячейку)"
      categories:
        type: string
        nullable: true
        description: "Диапазон категорий (например, 'Sheet1!$A$1:$A$5')"
      values:
        type: string
        description: "Диапазон значений (например, 'Sheet1!$B$1:$B$5')"
