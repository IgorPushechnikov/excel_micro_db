# Go-экспортер (go_excel_exporter)

Go-утилита `go_excel_exporter.exe` предназначена для генерации `.xlsx` файлов на основе JSON-данных, подготовленных Python-частью приложения Excel Micro DB.

## Назначение

Эта утилита принимает JSON-файл, соответствующий [спецификации](../../spec/go_excel_exporter_input_spec.yaml), и использует библиотеку `excelize` для создания Excel-файла. Она является частью архитектуры экспорта, описанной в [документации проекта](../../docs/export_spec.md).

## Зависимости

*   [github.com/xuri/excelize/v2](https://github.com/xuri/excelize): Библиотека для работы с Excel файлами.

## Использование

```bash
go_excel_exporter -input <input.json> -output <output.xlsx>
```

*   `-input`: Путь к JSON-файлу с данными проекта.
*   `-output`: Путь, по которому будет создан итоговый `.xlsx` файл.

## Входные данные (JSON)

Утилита ожидает JSON, соответствующий структуре `ExportData`, определённой в `main.go` (и описанной в `spec/go_excel_exporter_input_spec.yaml`).

*   **`metadata`**: Информация о проекте (пока не используется напрямую).
*   **`sheets`**: Массив объектов `SheetData`.
    *   **`name`**: Имя листа.
    *   **`data`**: Двумерный массив значений ячеек.
    *   **`formulas`**: Массив объектов `Formula` (ячейка, формула).
    *   **`styles`**: Массив объектов `Style` (диапазон, словарь атрибутов стиля).
    *   **`charts`**: Массив объектов `Chart` (тип, позиция, серии и т.д.).
    *   **`merged_cells`**: Массив строк, описывающих объединённые диапазоны (например, "A1:B2").

## Обработка стилей

Go-утилита должна обрабатывать структуру `Style`, в частности поле `style`, которое содержит "очищенный" словарь атрибутов стиля, подготовленный Python-модулем `style_converter.py`. Этот словарь содержит конкретные значения (например, `{"rgb": "FF0000"}` для цвета), которые могут быть напрямую переданы в `excelize.Style`.

## Обработка диаграмм

Go-утилита должна обрабатывать структуру `Chart`, включая `type`, `position`, `title` и `series`. Важно корректно обрабатывать поля, которые могут быть `null` в JSON (например, `name` или `categories` в `ChartSeries`).

## Сборка

Утилита собирается из `main.go` с помощью `go build`.

```bash
cd src/exporter/go
go build -o go_excel_exporter.exe main.go
```
